## ゲーム制作講座

# シングルトンとは

インスタンスを一つしか持たないクラスのことをシングルトンと呼ぶ。  

# 作り方

最もシンプルなシングルトンの実現方法はコンストラクタをprivateにしてしまうものだ。  

```cpp
class Singleton {
private:
	Singleton() = default;
	~Singleton() = default;

    //コピー禁止
    Singleton(Singleton &) = delete;
	Singleton &operator=(Singleton &) = delete;

public:
	static Singleton &get() {
		static Singleton ins;
		return ins;
	}
};
```

```Singleton::get()```を通じてのみインスタンスにアクセスできる。  

この方法はインスタンスが破棄される順番が指定できず、予期せぬエラーが発生しうる。  
(Visual Studio は生成と逆順に破棄されることが保証されてるらしい)  

シングルトンの実現方法は様々あり、そこら中にいろいろ工夫がされたものが転がってるのでググってみてもいいかもしれない。  

# 無名クラス

クラスのインスタンスが一つならば、クラス名を省略してインスタンスのみにしたい。  
これを実現するのが無名クラスだ。  

```cpp
class {
private:
    int a = 10;

public:
    void f() {
        std::cout << a << std::endl;
    }
} hoge;
```

無名クラスはコンストラクタとデストラクタが存在しない。  
メンバ変数の初期化は定義時に=で行う。  
関数のプロトタイプと区別をつけるためにクラスのコンストラクタの引数は{}で行う。  
これは普通のクラスでもできる。  

```cpp
class Hoge {
public:
    int a;
    Hoge(int a) : a(a) {}
};

class Fuga {
public:
    int a = 10; //10で初期化
    void f(); //メンバ関数
    Hoge h{20}; //クラスのインスタンス作成

    Fuga() : 
        a(20), //
        h(30)  //イニシャライザで明示的に初期化方法が指定された場合上の値は無視
    {}
};
```

